# ============================================
# TMUX Configuration - Learning Setup
# ============================================

# --------------------------------------------
# PREFIX KEY
# --------------------------------------------
# Change prefix from Ctrl+b to Ctrl+a
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# --------------------------------------------
# GENERAL SETTINGS
# --------------------------------------------
# Enable mouse support (great for learning)
set -g mouse on

# Start window numbering at 1 (easier to reach)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Increase history limit
set -g history-limit 10000

# Reduce escape time (faster response)
set -sg escape-time 10

# Increase repeat time (time to enter command after prefix)
set -g repeat-time 750

# Enable 256 colors with true color support
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*:Tc,*:256"

# --------------------------------------------
# STATUS BAR
# --------------------------------------------
# Status bar position
set -g status-position bottom

# Update status bar every second
set -g status-interval 1

# Status bar colors
set -g status-style 'bg=#2e3440 fg=#d8dee9'

# Left side: session name
set -g status-left-length 30
set -g status-left '#[fg=#88c0d0,bold] [#S] '

# Right side: prefix indicator + time
set -g status-right-length 60
set -g status-right '#{?client_prefix,#[fg=#ebcb8b]‚å® PREFIX ,}#[fg=#a3be8c]%H:%M #[fg=#81a1c1]%d-%b '

# Window status
setw -g window-status-format ' #I:#W '
setw -g window-status-current-format '#[fg=#2e3440,bg=#88c0d0,bold] #I:#W '

# --------------------------------------------
# PANE SETTINGS
# --------------------------------------------
# Pane border colors (minimal)
set -g pane-border-style 'fg=#3b4252'
set -g pane-active-border-style 'fg=#3b4252'

# Pane border status line (shows indicator at top of each pane)
set -g pane-border-status top
set -g pane-border-format '#{?pane_active,#[fg=#2e3440,bg=#5ee7ff,bold] #P: #{pane_current_command} ,#[fg=#4c566a] #P: #{pane_current_command} }'

# Dim inactive panes (only background, preserve text colors)
set -g window-style 'bg=#1a1d23'
set -g window-active-style 'bg=#0d0d0d'

# Display pane numbers longer
set -g display-panes-time 2000

# --------------------------------------------
# KEY BINDINGS
# --------------------------------------------
# Reload config with prefix + r
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# Toggle cheatsheet with prefix + ?
bind '?' run-shell "$HOME/.tmux/scripts/toggle-cheatsheet.sh"

# Easier pane splitting (more intuitive keys)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Join window as pane (reverse of ! which breaks pane to window)
bind @ choose-tree -Zw "join-pane -h -t '%%'"

# Keep default split bindings too
bind % split-window -h -c "#{pane_current_path}"
bind '"' split-window -v -c "#{pane_current_path}"

# Pane navigation with arrow keys (prefix + arrow, repeatable)
bind -r Left select-pane -L
bind -r Right select-pane -R
bind -r Up select-pane -U
bind -r Down select-pane -D

# Pane resizing with Ctrl+arrow (prefix + Ctrl+arrow)
bind C-Left resize-pane -L 5
bind C-Right resize-pane -R 5
bind C-Up resize-pane -U 5
bind C-Down resize-pane -D 5

# Pane resizing with vim keys (prefix + H/J/K/L)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Equalize pane sizes (preserves layout structure)
bind = select-layout -E

# New window in current path
bind c new-window -c "#{pane_current_path}"

# --------------------------------------------
# COPY MODE (vi style)
# --------------------------------------------
setw -g mode-keys vi

# Enter copy mode
bind [ copy-mode

# In copy mode, use v to select and y to yank
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# --------------------------------------------
# MESSAGES
# --------------------------------------------
set -g message-style 'fg=#2e3440 bg=#ebcb8b bold'
set -g display-time 2000
